<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>

    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css" integrity="sha512-17EgCFERpgZKcm0j0fEq1YCJuyAWdz9KUtv1EjVuaOz8pDnh/0nZxmU6BBXwaaxqoi9PQXnRWqlcDB027hgv9A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.css"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/preview.css" />
    <link rel="stylesheet" href="/css/navbar.css" />
    <link rel="stylesheet" href="/css/usernavbar.css" />
    <script src="https://unpkg.com/phosphor-icons"></script>
  </head>
  <body>

    <%FindStoryData.forEach(element => { %>
<section class="story section">
 <div class="project-area">
   <div class="head-container flex justify-center ">
     <div class="left-area">
        <div class="user_story_picture">
          <figure>
           
            <img
              class="card-cover-img"
              src="data:image/<%=element.CoverPicture.contentType%>;base64,
              <%=element.CoverPicture.data.toString('base64')%>"
              alt="Sample"
              title="Cover picture of the story"
            />
            <figcaption> 
              <div class="transparent_bg">
                <p class="bottom-right">Created at <span id="creationDate"><%= new Date([month,date,year].join("/")).toLocaleDateString("en-US",{ day:"numeric", month:"long", year:"numeric"})%></span></p>
              </div>
               
              </figcaption>
        </figure>
        
          </div>
        
          <p class="caption_of_story" id="title"><%= element["StoryTitle"] %></p>
        </div>
        <div class="right-area">
            <div class="collected_money_section">
              <p class="amount_head">collected money</p>
              <p class="amount">
                ৳
                <label id="curr_amount" style="font-size: 22px">
                  <%= element["CurrentAmount"] %>
                </label>
              </p>
              <div class="progress">
                <progress id="progress" value="0" max="100"></progress>
              </div>
              <p
                style="margin: 10px 0; color: rgb(134, 129, 129); font-weight: bold"
              >
                Goal : ৳ <label id="goal"> <%= element["TargetAmount"] %></label>
              </p>
            </div>
            <div class="remaining_days">
              <span class="days"> Remaining Days : </span>
              <label id="project_validity"> <%= DaysRemaining %></label>
              <span class="count">
                <label id="days" style="font-weight: bold; color: #000"></label>
              </span>
            </div>
           
            <% if(element["CurrentAmount"] >= element["TargetAmount"] || DaysRemaining === 0  ){ %>
              <div id="project_end_message" class="project-ended-message">
                <button>This project has finished !  </button> 
              </div>
            <%} %>
          
             
            </div>
        </div>
        <div class="support-container flex gap justify-center">
            <div class="left-area">
              <p
              style="
                margin: 30px 0 10px;
                text-align: left;
                font-weight: bold;
                font-size: 23px;
              "
            >
              people who supported :
              <label id="profile_count"> <%= SupporterLength %></label>
            </p>
            <hr style=" width: 100%; border: 1px solid black;" />
            
  
            <div  id="supporters" class="supporters">
              <% if (SupporterProfile.length !=0) { %>
              <div style="height: 120px; padding: 20px 0 10px 0;" id="support-profile" class="supported_user_profile   ">
               <% for(var  i=0; i<SupporterProfile.length; i++)  {%>     <!--this will be changed later -->
              <a class="item"  href="#">
                <img
                style="
                  border-radius: 50%;
                  width: 70px;
                  height: 70px;
                  border: 1px solid black;
                  margin: 0 10px;
                  object-fit: cover;
                "
                src="data:image/<%=SupporterProfile[i].profileImage.contentType%>;base64,
            <%=SupporterProfile[i].profileImage.data.toString('base64')%>"
                alt="supporter-profilePic"
                title="<%= SupporterProfile[i].user_name %>"
              />
              </a>
                <% } %>

                <!-- <span class="more-supporters">
                 
                    <i onclick="open_window()" class="ph-dots-three-outline-fill"></i>
             
                </span> -->
              
              </div>
    
            
              
              
              <% } else { %>
                <div style="width: 100%; margin: 30px 0 10px 0; " class="some_suggestion">
                  <p  style="text-align: center; font-size: 17px;"> No supporters available </p>
                  
                </div>
              <% } %>
            </div>
            </div>
            <div class="right-area">
                <div class="easy_fund">
                    <div class="about_easy_fund">
                      <div class="icon">
                        <span class="material-icons"> public </span>
                    </div>
                    <div style="padding: 5px 10px" class="text">
                      <span style="font-weight: bold"> What is Easy Fund ?</span>
                    </div>
                  </div>
                  <p>
                    Lorem ipsum dolor sit amet consectetur adipisicing elit. menda
                    deleniti. In reprehenderit eveniet asperiores?
                </p>

               
              </div>

        

            </div>
        </div>
        <div class="story-container flex justify-center column">
            <p
            style="
              margin: 30px 0 15px 0;
              text-align: left;
              font-weight: bold;
              font-size: 23px;
            "
          >
            Story
          </p>
          <hr style=" width: 100%; border: 1px solid black;" />
          <div class="story_teller">
            <div class="user_profile">
              <img
                style="border-radius: 50%;object-fit: cover; width: 80px; height:80px; border: 1px solid black"
                src="data:image/<%=picture.contentType%>;base64,
          <%=picture.data.toString('base64')%>"
                alt="profilePic"
              />
            </div>
            <div class="user_identity">
              <p class="username"><%= fullname %></p>
              <p class="identity"><%= university %></p>
            </div>
          </div>
          
            <textarea
            style="font-family: system-ui; font-size: 18px; width: 100%;"
            readonly
            id="mainStory"
            class="main_story"
          >
      <%= element["MainStory"] %></textarea
          >
          
          
          
      <div>
        <% if(AttachmentLength) { %> <% element.Attachments.forEach((file) => {
          %>
        <div class="gallery">
          <img
            src="data:image/<%=file.contentType%>;base64,
          <%=file.data.toString('base64')%>"
            alt="attachment-<%= file._id %>"
            width="600"
            height="500"
          />
        </div>
        <% }) %> <% } %>
      </div>
          
       
        </div>
       
      </div>
      <% }); %>
          
      </section>

      <div class="button_container">
      <hr />
      <div class="flex_container">
        <div id="success" class="btn">
          <button class="suggested_btn"  type="submit">
            Success
          </button>
        </div>

        <div id="failure" class="btn">
          <button  class="suggested_btn"  type="submit">
           Failure
          </button>
        </div>


        <div id="funded" class="btn">
          <button class="suggested_btn"  type="submit">Funded</button>
        </div>
      </div>
    </div>

    <script defer src="/js/admin/StoryPage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
<script>
$('.supported_user_profile').slick({
  dots: true,
  infinite: false,
  speed: 300,
  slidesToShow: 5,
  slidesToScroll: 1,
  responsive: [
    {
      breakpoint: 1024,
      settings: {
        slidesToShow: 3,
        slidesToScroll: 1,
        infinite: true,
        dots: true
      }
    },
    {
      breakpoint: 600,
      settings: {
        slidesToShow: 2,
        slidesToScroll: 1
      }
    },
    {
      breakpoint: 480,
      settings: {
        slidesToShow: 1,
        slidesToScroll: 1
      }
    }
    // You can unslick at a given breakpoint now by adding:
    // settings: "unslick"
    // instead of a settings object
  ]
});

				
</script>


</body>
</html>
